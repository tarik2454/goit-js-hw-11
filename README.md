# CRUD. Асинхронные функции | goit-js-hw-11

## Критерии приема

- Создан репозиторий `goit-js-hw-11`.
- При сдаче домашней работы есть две ссылки: на исходные файлы и рабочую страницу на `GitHub Pages`.
- При посещении живой страницы задания, в консоли нету ошибок и предупреждений.
- Проект собран с помощью
  [parcel-project-template](https://github.com/goitacademy/parcel-project-template).
- Для HTTP запросов использована библиотека [axios](https://axios-http.com/).
- Используется синтаксис async/await. Для уведомлений использована библиотека
  [notiflix](https://github.com/notiflix/Notiflix#readme).
- Код отформатирован `Prettier`.

### Задание - поиск изображений

Создай фронтенд часть приложения поиска и просмотра изображений по ключевому слову. Добавь
оформление элементов интерфейса. Посмотри демо видео работы приложения.

#### Форма поиска

Форма изначально есть в HTML документе. Пользователь будет вводить строку для поиска в текстовое
поле, а при сабмите формы необходимо выполнять HTTP-запрос.

```
<form class="search-form" id="search-form">
  <input
    type="text"
    name="searchQuery"
    autocomplete="off"
    placeholder="Search images..."
  />
  <button type="submit">Search</button>
</form>
```

#### HTTP-запросы

В качестве бэкенда используй публичный API сервиса [Pixabay](https://pixabay.com/api/docs/).
Зарегистрируйся, получи свой уникальный ключ доступа и ознакомься с документацией.

Список параметров строки запроса которые тебе обязательно необходимо указать:

- `key` - твой уникальный ключ доступа к API.
- `q` - термин для поиска. То, что будет вводить пользователь.
- `image_type` - тип изображения. Мы хотим только фотографии, поэтому задай значение `photo`.
- `orientation` - ориентация фотографии. Задай значение `horizontal`.
- `safesearch` - фильтр по возрасту. Задай значение `true`. В ответе будет массив изображений
  удовлетворивших критериям параметров запроса. Каждое изображение описывается объектом, из которого
  тебе интересны только следующие свойства:

- `webformatURL` - ссылка на маленькое изображение для списка карточек.
- `largeImageURL` - ссылка на большое изображение.
- `tags` - строка с описанием изображения. Подойдет для атрибута `alt`.
- `likes` - количество лайков.
- `views` - количество просмотров.
- `comments` - количество комментариев.
- `downloads` - количество загрузок.

Если бэкенд возвращает пустой массив, значит ничего подходящего найдено небыло. В таком случае
показывай уведомление с текстом
`"Sorry, there are no images matching your search query. Please try again."`. Для уведомлений
используй библиотеку [notiflix](https://github.com/notiflix/Notiflix#readme).

#### Галерея и карточка изображения

Элемент `div.gallery` изначально есть в HTML документе, и в него необходимо рендерить разметку
карточек изображений. При поиске по новому ключевому слову необходимо полностью очищать содержимое
галереи, чтобы не смешивать результаты.

```
<div class="gallery">
  <!-- Карточки изображений -->
</div>
```

Шаблон разметки карточки одного изображения для галереи.

```
<div class="photo-card">
  <img src="" alt="" loading="lazy" />
  <div class="info">
    <p class="info-item">
      <b>Likes</b>
    </p>
    <p class="info-item">
      <b>Views</b>
    </p>
    <p class="info-item">
      <b>Comments</b>
    </p>
    <p class="info-item">
      <b>Downloads</b>
    </p>
  </div>
</div>
```

#### Пагинация

Pixabay API поддерживает пагинацию и предоставляет параметры `page` и `per_page`. Сделай так, чтобы
в каждом ответе приходило 40 объектов (по умолчанию 20).

- Изначально значение параметра page должно быть 1.
- При каждом последующем запросе, его необходимо увеличить на 1.
- При поиске по новому ключевому слову значение page надо вернуть в исходное, так как будет
  пагинация по новой коллекции изображений.

В HTML документе уже есть разметка кнопки при клике по которой необходимо выполнять запрос за
следующей группой изображений и добавлять разметку к уже существующим элементам галереи.

```
<button type="button" class="load-more">Load more</button>
```

- Изначально кнопка должна быть скрыта.
- После первого запроса кнопка появляется в интерфейсе под галереей.
- При повторном сабмите формы кнопка сначала прячется, а после запроса опять отображается.

В ответе бэкенд возвращает свойство `totalHits` - общее количество изображений которые подошли под
критерий поиска (для бесплатного аккаунта). Если пользователь дошел до конца коллекции, пряч кнопку
и выводи уведомление с текстом `"We're sorry, but you've reached the end of search results."`.

#### Дополнительно

> :warning: ВНИМАНИЕ Этот функционал не обязателен при сдаче задания, но будет хорошей
> дополнительной практикой.

#### Уведомление

После первого запроса при каждом новом поиске выводить уведомление в котором будет написано сколько
всего нашли изображений (свойство `totalHits`). Текст уведомления
`"Hooray! We found totalHits images."`

#### Библиотека `SimpleLightbox`

Добавить отображение большой версии изображения с библиотекой
[SimpleLightbox](https://simplelightbox.com/) для полноценной галереи.

- В разметке необходимо будет обернуть каждую карточку изображения в ссылку, как указано в
  документации.
- У библиотеки есть метод `refresh()` который обязательно нужно вызывать каждый раз после добавления
  новой группы карточек изображений.

Для того чтобы подключить CSS код библиотеки в проект, необходимо добавить еще один импорт, кроме
того который описан в документации.

```
// Описан в документации import SimpleLightbox from "simplelightbox"; // Дополнительный импорт
стилей import "simplelightbox/dist/simple-lightbox.min.css";
```

#### Прокрутка страницы

Сделать плавную прокрутку страницы после запроса и отрисовки каждой следующей группы изображений.
Вот тебе код подсказка, а разберись в нём самостоятельно.

```
const { height: cardHeight } = document .querySelector(".gallery")
.firstElementChild.getBoundingClientRect();

window.scrollBy({ top: cardHeight \* 2, behavior: "smooth", });
```

#### Бесконечный скролл

Вместо кнопки «Load more» можно сделать бесконечную загрузку изображений при прокрутке страницы. Мы
предоставлям тебе полную свободу действий в реализации, можешь использовать любые библиотеки.

***

# Parcel template

Этот проект был создан при помощи Parcel. Для знакомства и настройки
дополнительных возможностей [обратись к документации](https://parceljs.org/).

## Подготовка нового проекта

1. Убедись что на компьютере установлена LTS-версия Node.js.
   [Скачай и установи](https://nodejs.org/en/) её если необходимо.
2. Склонируй этот репозиторий.
3. Измени имя папки с `parcel-project-template` на имя своего проекта.
4. Создай новый пустой репозиторий на GitHub.
5. Открой проект в VSCode, запусти терминал и свяжи проект с GitHub-репозиторием
   [по инструкции](https://docs.github.com/en/get-started/getting-started-with-git/managing-remote-repositories#changing-a-remote-repositorys-url).
6. Установи зависимости проекта в терминале командой `npm install` .
7. Запусти режим разработки, выполнив команду `npm start`.
8. Перейди в браузере по адресу [http://localhost:1234](http://localhost:1234).
   Эта страница будет автоматически перезагружаться после сохранения изменений в
   файлах проекта.

## Файлы и папки

- Все паршалы файлов стилей должны лежать в папке `src/sass` и импортироваться в
  файлы стилей страниц. Например, для `index.html` файл стилей называется
  `index.scss`.
- Изображения добавляй в папку `src/images`. Сборщик оптимизирует их, но только
  при деплое продакшн версии проекта. Все это происходит в облаке, чтобы не
  нагружать твой компьютер, так как на слабых машинах это может занять много
  времени.

## Деплой

Для настройки деплоя проекта необходимо выполнить несколько дополнительных шагов
по настройке твоего репозитория. Зайди во вкладку `Settings` и в подсекции
`Actions` выбери выбери пункт `General`.

![GitHub actions settings](./assets/actions-config-step-1.png)

Пролистай страницу до последней секции, в которой убедись что выбраны опции как
на следующем изображении и нажми `Save`. Без этих настроек у сборки будет
недостаточно прав для автоматизации процесса деплоя.

![GitHub actions settings](./assets/actions-config-step-2.png)

Продакшн версия проекта будет автоматически собираться и деплоиться на GitHub
Pages, в ветку `gh-pages`, каждый раз когда обновляется ветка `main`. Например,
после прямого пуша или принятого пул-реквеста. Для этого необходимо в файле
`package.json` отредактировать поле `homepage` и скрипт `build`, заменив
`your_username` и `your_repo_name` на свои, и отправить изменения на GitHub.

```json
"homepage": "https://your_username.github.io/your_repo_name/",
"scripts": {
  "build": "parcel build src/*.html --public-url /your_repo_name/"
},
```

Далее необходимо зайти в настройки GitHub-репозитория (`Settings` > `Pages`) и
выставить раздачу продакшн версии файлов из папки `/root` ветки `gh-pages`, если
это небыло сделано автоматически.

![GitHub Pages settings](./assets/repo-settings.png)

### Статус деплоя

Статус деплоя крайнего коммита отображается иконкой возле его идентификатора.

- **Желтый цвет** - выполняется сборка и деплой проекта.
- **Зеленый цвет** - деплой завершился успешно.
- **Красный цвет** - во время линтинга, сборки или деплоя произошла ошибка.

Более детальную информацию о статусе можно посмотреть кликнув по иконке, и в
выпадающем окне перейти по ссылке `Details`.

![Deployment status](./assets/status.png)

### Живая страница

Через какое-то время, обычно пару минут, живую страницу можно будет посмотреть
по адресу указанному в отредактированном свойстве `homepage`. Например, вот
ссылка на живую версию для этого репозитория
[https://goitacademy.github.io/parcel-project-template](https://goitacademy.github.io/parcel-project-template).

Если открывается пустая страница, убедись что во вкладке `Console` нет ошибок
связанных с неправильными путями к CSS и JS файлам проекта (**404**). Скорее
всего у тебя неправильное значение свойства `homepage` или скрипта `build` в
файле `package.json`.

## Как это работает

![How it works](./assets/how-it-works.png)

1. После каждого пуша в ветку `main` GitHub-репозитория, запускается специальный
   скрипт (GitHub Action) из файла `.github/workflows/deploy.yml`.
2. Все файлы репозитория копируются на сервер, где проект инициализируется и
   проходит сборку перед деплоем.
3. Если все шаги прошли успешно, собранная продакшн версия файлов проекта
   отправляется в ветку `gh-pages`. В противном случае, в логе выполнения
   скрипта будет указано в чем проблема.
